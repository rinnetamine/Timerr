<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Timerr</title>
    <link rel="stylesheet" href="./style.css">
    <link rel="icon" href="media/favicon.ico" type="image/x-icon">
  </head>

  <body>
    <header>
      <h1>Timerr</h1>
      <nav>
        <!-- desktop -->
        <ul id="pc-only">
          <li><a href="home.html">Browse</a></li>
          <li><a href="about.html">About</a></li>
          <li><a href="contact.html">Contact</a></li>

          <li class="dropdown">
            <a href="services.html" class="drop">Services ⮟</a>
            <ul class="dropdown-content"> 
              <li class="dropdown">
                <a href="list.html" class="drop">List ⮟</a>
                <ul class="dropdown-content nested"> 
                  <li><a href="#">Hottest</a></li>
                  <li><a href="#">Newest</a></li>
                </ul>  
              </li>
              <li><a href="request.html" class="drop">Request</a></li>
              <li><a href="offer.html">Offer</a></li>
            </ul>
          </li>
          <li><a href="#" id="loginBtn">Login</a></li>
          <li><a id="dark-mode-button" onclick="dark_mode()">Dark mode</a></li>
        </ul>
        
  <div id="hamburger" class="hamburger" onclick="toggleMenu()">&#9776;</div>

  <!-- mobile -->
<ul id="mobile-only">
  <div id="hamburger" onclick="toggleMenu()">&times;</div>
  <li><a href="home.html">Browse</a></li>
  <li><a href="about.html">About</a></li>
  <li><a href="contact.html">Contact</a></li>
  <li>
    <a href="services.html">Services</a>
    <ul class="service-submenu">
      <li>
        <a href="list.html">List</a>
        <ul class="service-submenu-nested">
          <li><a href="#">Hottest</a></li>
          <li><a href="#">Newest</a></li>
        </ul>
      </li>
      <li><a href="request.html">Request</a></li>
      <li><a href="offer.html">Offer</a></li>
    </ul>
  </li>
  <li><a id="dark-mode-button" onclick="dark_mode()">Dark mode</a></li>
  <li><a href="#" id="loginBtn">Login</a></li>
</ul>

 <!-- log modal -->
 <div id="loginModal" class="modal">
  <div class="modal-content">
    <span class="close" onclick="closeLoginModal()">&times;</span>
    <h2>Login</h2>
    <form id="loginForm">
      <input type="text" id="username" placeholder="Username" required>
      <input type="password" id="password" placeholder="Password" required>
      <button type="submit" class="button-login">Login</button>
    </form>
    <p id="errorMessage" style="color:red;"></p>
    <button class="button-register" id="registerBtn" onclick="toggleToRegister()">Register</button>
  </div>
</div>

<!-- reg modal -->
<div id="registerModal" class="modal" style="display:none;">
  <div class="modal-content">
    <span class="close" onclick="closeRegisterModal()">&times;</span>
    <h2>Register</h2>
    <form id="registerForm">
      <input type="text" id="newUsername" placeholder="Username" required>
      <input type="password" id="newPassword" placeholder="Password" required>
      <button type="submit" class="button-login">Register</button>
    </form>
    <p id="registerMessage" style="color:red;"></p>
    <button class="button-register" id="loginBackBtn" onclick="toggleToLogin()">Back to Login</button>
  </div>
</div>

</nav>
    </header>
    
    <main>
      <section class="what-is-timerr">
        <h2>What is Timerr?</h2>
        <p>Timerr is a web platform that combines the ideas of Fiverr (freelance services) and TimeBank (using time as currency).</p>
      </section>

      <div class="how-it-works">
        <section class="how-timerr-works">
          <h2>How does Timerr work?</h2>
          <p>Timerr allows users to offer services to others in exchange for time. Services are posted, verified, and time credits are managed on the platform.</p>
        </section>
        <img id="time_rr" src="media/time_rr.png" width="500" height="500">
      </div>

      <section class="key-features">
        <h2>Key Features</h2>
        <ul>
          <li><b>Profile Management: </b>Create and edit your profile, add/edit/delete services.</li>
          <li><b>Search and Request Services: </b>Find or request needed services.</li>
          <li><b>Service Verification: </b>Admins review and approve services.</li>
          <li><b>Time Management: </b>Manage your time credits.</li>
        </ul>
      </section>
    </main>

    <!-- cards -->
    <div class="flex-container">
      <div class="card">
        <img id="list" src="media/list.png" alt="List requests">
        <div class="card-content">
          <h3>List offers!</h3>
          <p>Search from already available services.</p>
          <button class="button-3" role="button" id="openModalBtn1">Learn More!</button>
        </div>
      </div>

      <div class="card">
        <img id="request" src="media/request.png" alt="Request services">
        <div class="card-content">
          <h3>Request services!</h3>
          <p>Ask for help if you can't find from available.</p>
          <button class="button-3" role="button" id="openModalBtn2">Learn More!</button>
        </div>
      </div>

      <div class="card">
        <img id="offer" src="media/offer.png" alt="Offer services">
        <div class="card-content">
          <h3>Offer services!</h3>
          <p>Earn your time by offering something.</p>
          <button class="button-3" role="button" id="openModalBtn3">Learn More!</button>
        </div>
      </div>
    </div>

   <!-- modal for cards -->
    <div id="modal1" class="modal">
      <div class="modal-content">
        <span class="close">&times;</span>
        <p>Search for needed services from the whole spectrum that's already on site!</p>
      </div>
    </div>

    <div id="modal2" class="modal">
      <div class="modal-content">
        <span class="close">&times;</span>
        <p>Can't find something you need? Ask someone!</p>
      </div>
    </div>

    <div id="modal3" class="modal">
      <div class="modal-content">
        <span class="close">&times;</span>
        <p>Not enough hours? Offer something and do your best!</p>
      </div>
    </div>

    <script>
      function dark_mode() {
        var element = document.body;
        element.classList.toggle("dark-mode");
        // dark mode img change
        var image = document.getElementById("time_rr");
        if (image.src.includes("media/time_rr.png")) {
          image.src = "media/time_rr_dark.png";
        } else {
          image.src = "media/time_rr.png";
        }

        var image = document.getElementById("list");
        if (image.src.includes("media/list.png")) {
          image.src = "media/list_dark.png";
        } else {
          image.src = "media/list.png";
        }

        var image = document.getElementById("offer");
        if (image.src.includes("media/offer.png")) {
          image.src = "media/offer_dark.png";
        } else {
          image.src = "media/offer.png";
        }

        var image = document.getElementById("request");
        if (image.src.includes("media/request.png")) {
          image.src = "media/request_dark.png";
        } else {
          image.src = "media/request.png";
        }
      }
      //opening card modals
      const openModalBtn1 = document.getElementById("openModalBtn1");
      const openModalBtn2 = document.getElementById("openModalBtn2");
      const openModalBtn3 = document.getElementById("openModalBtn3");

      const modal1 = document.getElementById("modal1");
      const modal2 = document.getElementById("modal2");
      const modal3 = document.getElementById("modal3");

      const closeBtns = document.getElementsByClassName("close");

      openModalBtn1.onclick = function() {
        modal1.style.display = "flex";
      }

      openModalBtn2.onclick = function() {
        modal2.style.display = "flex";
      }

      openModalBtn3.onclick = function() {
        modal3.style.display = "flex";
      }

      for (let i = 0; i < closeBtns.length; i++) {
        closeBtns[i].onclick = function() {
          closest(".modal").style.display = "none";
        }
      }
      // mobile menu button
      function toggleMenu() {
        const menu = document.getElementById("mobile-only");
        const hamburger = document.getElementById("hamburger");
        
        menu.classList.toggle("active");
        hamburger.classList.toggle("open");
      }

      document.addEventListener("DOMContentLoaded", function () {
          const loginBtn = document.getElementById("loginBtn");
          const loginModal = document.getElementById("loginModal");
          const loginForm = document.getElementById("loginForm");
          const errorMessage = document.getElementById("errorMessage");
          const registerModal = document.getElementById("registerModal");
          const registerForm = document.getElementById("registerForm");
          const registerMessage = document.getElementById("registerMessage");
          const registerBtn = document.getElementById("registerBtn");
          const loginBackBtn = document.getElementById("loginBackBtn");
          
          let users = JSON.parse(localStorage.getItem("users")) || {};

          // login modal on click
          loginBtn.addEventListener("click", function () {
              loginModal.style.display = "flex";
          });

          // register modal on click
          registerBtn.addEventListener("click", function () {
              loginModal.style.display = "none";
              registerModal.style.display = "flex";
          });

          // close modal when clicking outside
          window.onclick = function (event) {
              if (event.target === loginModal) {
                  loginModal.style.display = "none";
              } else if (event.target === registerModal) {
                  registerModal.style.display = "none";
              }
          };

            // handle login form submission
            loginForm.addEventListener("submit", function (event) {
              event.preventDefault();
              
              const username = document.getElementById("username").value;
              const password = document.getElementById("password").value;
              
              if (users[username] && users[username] === password) {
                localStorage.setItem("username", username);
                localStorage.setItem("loggedIn", "true"); 
                updateLoginButton(); 
                loginModal.style.display = "none"; 
              } else {
                errorMessage.textContent = "Invalid username or password";
              }
            });

            // Handle register form submission
            registerForm.addEventListener("submit", function (event) {
              event.preventDefault();
              
              const newUsername = document.getElementById("newUsername").value;
              const newPassword = document.getElementById("newPassword").value;
              
              if (users[newUsername]) {
                registerMessage.textContent = "Username already taken.";
              } else {
                users[newUsername] = newPassword;
                localStorage.setItem("users", JSON.stringify(users));
                registerMessage.textContent = "Registration successful! You can now log in.";
                setTimeout(() => {
                  registerModal.style.display = "none";
                  loginModal.style.display = "flex";
                }, 1500);
              }
            });

          // login to register button
          loginBackBtn.addEventListener("click", function () {
              registerModal.style.display = "none";
              loginModal.style.display = "flex";
          });

          function updateLoginButton() {
              // check if the user is logged in
              const username = localStorage.getItem("username");

              if (username) {
                  loginBtn.textContent = "Profile";
                  loginBtn.href = "profile.html";
              } else {
                  loginBtn.textContent = "Login";
                  loginBtn.href = "#";
              }
          }

          updateLoginButton();
      });
    </script>

  </body>
</html>